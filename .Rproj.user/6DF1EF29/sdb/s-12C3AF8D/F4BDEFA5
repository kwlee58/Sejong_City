{
    "collab_server" : "",
    "contents" : "---\ntitle: \"세종시 자체평가 자료\"\nauthor: \"coop711\"\ndate: \"`r Sys.Date()`\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(pander)\nlibrary(knitr)\n```\n----\n\n### 분과별 점수조정 평균\n\n```{r, data, echo = FALSE, results = 'hide'}\ndata <- read.table(\"data.txt\")\nnames(data) <- c(\"Project\", \"Division\", \"Before\", \"After\", \"Budget\")\ndata$Division <- factor(data$Division, labels = 1:3)\ndata$Diff <- data$Before - data$After\ndata.kr <- data\nnames(data.kr) <- c(\"포괄보조사업\", \"분과\", \"부서점수\", \"위원회점수\", \"예산\", \"차이\")\n```\n\n```{r, mean differences, echo = FALSE}\npander(round(tapply(data$Diff, factor(data$Division), mean), digits = 1))\n```\n\n```{r, sorting, echo = FALSE}\nAfter.o <- order(data$After, decreasing = TRUE)\nBefore.o <- order(data$Before, decreasing = TRUE)\nProject.o <- data$Project[order(data$Division, data$After)]\nProject.f <- factor(data$Project, levels = Project.o)\n```\n\n----\n\n### 조정된 점수순 정리\n\n#### 평가위원회 점수 순\n\n```{r, sorted projects by After, echo = FALSE}\nkable(data.kr[After.o, ][, c(1:4, 6, 5)], align = c('l', rep('r', 5)))\n```\n\n#### 부서 점수 순\n\n```{r, sorted projects by Before, ech0 = FALSE}\nkable(data.kr[Before.o, ][, c(1:4, 6, 5)], align = c('l', rep('r', 5)))\n```\n\n----\n\n### 등급별 예산 비중(%)\n\n```{r, grades, echo = FALSE}\ndata$Grades <- factor(ifelse(rank(data$After) >= 18, \"우수\", ifelse(rank(data$After) >= 12, \"보통\", \"미흡\")), levels=c(\"우수\", \"보통\", \"미흡\"))\n```\n\n```{r, budget oercentages, echo = FALSE}\npander(round(tapply(data$Budget, factor(data$Grades), function(x)sum(x)*100/sum(data$Budget)), digits = 1))\n```\n\n```{r, plot, fig.width = 8, fig.height = 8, echo = FALSE}\n#plot(After ~ Before, data = data, xlim = c(60, 100), ylim = c(40, 100), type = \"n\")\n#text(x = data$Before, y = data$After, labels = data$Division)\n#text(x = data$Before, y = data$After, labels = data$Project, col = as.numeric(data$Division), cex = 0.5)\n```\n\n----\n\n### 부서 점수와 위원회 점수 비교\n\n```{r, dotplot, echo = FALSE}\nlibrary(ggplot2)\nlibrary(grid)\nsource(\"theme_kr_ASGN.R\")\n# g1 <- ggplot(data, aes(x = After, y = reorder(Project, After), colour = Division)) + geom_point(size = 3) + theme_bw() + theme.kr.ASGN\ng1 <- ggplot(data) + theme_bw() + theme.kr.ASGN\ng2 <- g1 + xlim(40, 100)\n# g3 <- g2 + geom_point(aes(x = Before, y = reorder(Project, After), colour = Division), size = 3) + xlab(\"위원회점수와 부서점수\") + ylab(\"포괄보조사업\")\ng3 <- g2\ng4 <- g3 + geom_segment(aes(x = Before, y = reorder(Project, After), xend = After, yend = Project, colour = Division), arrow = arrow(length = unit(0.1, \"inches\"), ends = \"both\", type = \"closed\"))\ng5 <- g4 + xlab(\"위원회점수와 부서점수\") + ylab(\"포괄보조사업\") + labs(colour = \"분과\") + theme(legend.position = c(.15,.8))\ng6 <- g5 + geom_hline(yintercept = c(11.5, 17.5), linetype = 3)\ng7 <- g6 + annotate(\"text\", x = c(70, 50), y = c(14.5, 6.5), label = c(\"보통\", \"미흡\"), family = \"Apple SD Gothic Neo\" )\ng7\n```\n\n### 분과별 부서 점수와 위원회 점수 비교\n\n```{r, dotplot_division, echo = FALSE}\nh1 <- ggplot(data) + theme_bw() + theme.kr.ASGN\nh2 <- h1 + xlim(40, 100)\nh3 <- h2 + geom_segment(aes(x = Before, y = Project.f, xend = After, yend = Project.f, colour = Division), arrow = arrow(length = unit(0.1, \"inches\"), ends = \"both\", type = \"closed\"))\nh4 <- h3 + xlab(\"위원회점수와 부서점수\") + ylab(\"포괄보조사업\") + labs(colour = \"분과\") + theme(legend.position = c(.15,.85))\nh5 <- h4 + geom_vline(xintercept = c(83.8, 91), linetype = 3)\nh5\n#h5 <- h4 + geom_hline(yintercept = c(11.5, 17.5), linetype = 3)\n#h6 <- h5 + annotate(\"text\", x = c(70, 50), y = c(14.5, 6.5), label = c(\"보통\", \"미흡\"), #family = \"Apple SD Gothic Neo\" )\n#h6\n```\n\n",
    "created" : 1457713688256.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2317934059",
    "id" : "F4BDEFA5",
    "lastKnownWriteTime" : 1457663858,
    "last_content_update" : 1457663858,
    "path" : "~/Google 드라이브/Works/Research_Data/Sejong_City/R/Sejong.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}